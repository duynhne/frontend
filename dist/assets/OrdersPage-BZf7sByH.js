import{c as S,e as f,r as j,j as e,L as O}from"./index-B_7VeGgU.js";import{g as L,a as k}from"./orderApi-C54mhc58.js";import{u as w,a as D,P as v,L as b,A as T}from"./ApiDebug-CcPvt7Y2.js";import{E as N}from"./EmptyState-CHFLAYQf.js";function $(){const t=S(),{notify:r}=f(),{isAuthenticated:o}=w(),[h,m]=j.useState(null),[i,x]=j.useState(null),[a,d]=j.useState(!1);j.useEffect(()=>{},[]);const{data:u,loading:l,error:n}=D(o?"orders":null,k),p=j.useMemo(()=>u||[],[u]),y=async s=>{m(s),d(!0),x(null);try{const c=await L(s);x(c)}catch{r("error","Failed to load order details")}finally{d(!1)}},g=s=>({pending:"var(--warning)",processing:"var(--info)",completed:"var(--success)",shipped:"var(--accent)",delivered:"var(--success)",in_transit:"var(--info)"})[s]||"var(--text-muted)";return o?e.jsxs("div",{className:"page container",children:[e.jsx(v,{title:"My Orders",backLink:"/",backText:"â† Back to Home",apiLabel:`API: GET /api/v1/orders â€¢ ${p.length} orders`}),l&&e.jsx(b,{message:"Loading orders...",variant:"list",count:3}),!l&&n&&e.jsxs("div",{className:"error",children:["Error: ",n]}),!l&&!n&&e.jsxs("div",{className:"two-col",children:[e.jsxs("div",{className:"card orders-history",children:[e.jsx("h3",{children:"Order History"}),p.length===0?e.jsx(N,{message:"No orders yet",icon:"ðŸ“¦",children:e.jsx(O,{to:"/",children:"Start Shopping"})}):e.jsx("div",{className:"table-wrapper",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Order"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Total"}),e.jsx("th",{className:"hide-mobile",children:"Date"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:p.map(s=>{var c;return e.jsxs("tr",{children:[e.jsxs("td",{children:["#",s.id]}),e.jsx("td",{children:e.jsx("span",{style:{color:g(s.status)},children:s.status})}),e.jsxs("td",{children:["$",(c=s.total)==null?void 0:c.toFixed(2)]}),e.jsx("td",{className:"hide-mobile",children:new Date(s.created_at).toLocaleDateString()}),e.jsx("td",{children:e.jsx("button",{onClick:()=>y(s.id),disabled:a&&h===s.id,children:a&&h===s.id?"...":"View"})})]},s.id)})})]})})]}),e.jsxs("div",{className:"card order-details",children:[e.jsx("h3",{children:"Order Details"}),a&&e.jsx(b,{message:"Loading order details..."}),!a&&i?e.jsx(A,{order:i.order,shipment:i.shipment,getStatusColor:g}):!a&&e.jsx("p",{className:"text-muted",children:"Select an order to view details"})]})]}),e.jsx(T,{data:{orders:p,selectedOrderData:i},label:"Orders API Response"})]}):e.jsxs("div",{className:"page container",children:[e.jsx(v,{title:"My Orders",backLink:"/",backText:"â† Back to Home"}),e.jsx(N,{message:"Please log in to view your orders",icon:"ðŸ”’"}),e.jsx("div",{style:{textAlign:"center",marginTop:"1rem"},children:e.jsx("button",{className:"primary",onClick:()=>t("/login?returnTo=/orders"),children:"Login"})})]})}function A({order:t,shipment:r,getStatusColor:o}){var h,m,i,x,a;return t?e.jsxs("div",{className:"order-details-panel",children:[e.jsxs("div",{className:"order-details-header",children:[e.jsx("div",{children:e.jsxs("strong",{children:["Order #",t.id]})}),e.jsx("span",{className:"order-status-badge",style:{color:o(t.status)},children:t.status}),e.jsx("div",{className:"text-muted order-details-date",children:new Date(t.created_at).toLocaleString()})]}),e.jsxs("div",{className:"two-col order-details-layout",children:[e.jsxs("div",{className:"card order-items-section",children:[e.jsx("h4",{children:"Order Items"}),e.jsx("div",{className:"table-wrapper",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Qty"}),e.jsx("th",{className:"hide-mobile",children:"Price"}),e.jsx("th",{children:"Subtotal"})]})}),e.jsx("tbody",{children:(h=t.items)==null?void 0:h.map((d,u)=>{var l,n;return e.jsxs("tr",{children:[e.jsx("td",{children:d.product_name}),e.jsx("td",{children:d.quantity}),e.jsxs("td",{className:"hide-mobile",children:["$",(l=d.price)==null?void 0:l.toFixed(2)]}),e.jsxs("td",{children:["$",(n=d.subtotal)==null?void 0:n.toFixed(2)]})]},u)})})]})})]}),e.jsxs("div",{className:"card order-summary-section",children:[e.jsx("h4",{children:"Order Summary"}),e.jsx("table",{children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{children:"Subtotal"}),e.jsxs("td",{children:["$",(m=t.subtotal)==null?void 0:m.toFixed(2)]})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Shipping"}),e.jsxs("td",{children:["$",(i=t.shipping)==null?void 0:i.toFixed(2)]})]}),e.jsxs("tr",{className:"order-total-row",children:[e.jsx("th",{children:e.jsx("strong",{children:"Total"})}),e.jsx("td",{children:e.jsxs("strong",{className:"order-total-value",children:["$",(x=t.total)==null?void 0:x.toFixed(2)]})})]})]})})]})]}),r&&e.jsxs("div",{className:"shipment-box",children:[e.jsx("strong",{children:"Shipment Tracking"}),e.jsxs("p",{children:["Carrier: ",r.carrier||"N/A"]}),e.jsxs("p",{children:["Status:"," ",e.jsx("span",{style:{color:o(r.status)},children:(a=r.status)==null?void 0:a.replace("_"," ").toUpperCase()})]}),e.jsxs("p",{children:["Tracking: ",r.tracking_number]}),r.estimated_delivery&&e.jsxs("p",{children:["Est: ",new Date(r.estimated_delivery).toLocaleDateString()]})]}),!r&&t.status==="shipped"&&e.jsx("div",{className:"shipment-box",children:e.jsx("p",{className:"text-muted",children:"Shipment info not available"})})]}):null}export{$ as default};
