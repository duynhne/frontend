import{a as j,c as E,r as n,j as e}from"./index-y3nl-1dH.js";import{u as A,a as k,P as x,L as C,A as S}from"./ApiDebug-YCnoPG3x.js";import{u as M}from"./useApiMutation-DEFwsEDw.js";import{A as L}from"./ApiError-Bd4zEiP4.js";import{E as w}from"./EmptyState-E_34ce5k.js";import"./errorMessages-JRjuVPVt.js";async function D(){return(await j.get("/users/profile")).data}async function F(s){return(await j.put("/users/profile",s)).data}function R(){const s=E(),{isAuthenticated:i,requireAuth:m}=A();n.useEffect(()=>{m(s,"/profile")},[m,s]);const{data:a,loading:r,error:t,mutate:u}=k(i?"user-profile":null,D),{mutate:g,loading:l}=M(F,{successMessage:"Profile updated!",errorMessage:"Failed to update profile"}),[v,o]=n.useState(!1),[c,d]=n.useState({name:"",phone:""});n.useEffect(()=>{a&&d({name:a.name||"",phone:a.phone||""})},[a]);const h=p=>{const{name:f,value:y}=p.target;d(P=>({...P,[f]:y}))},b=async p=>{p.preventDefault(),await g(c)&&(o(!1),u())},N=()=>{d({name:(a==null?void 0:a.name)||"",phone:(a==null?void 0:a.phone)||""}),o(!1)};return i?e.jsxs("div",{className:"page container",children:[e.jsx(x,{title:"My Profile",backLink:"/",backText:"â† Back to Home",apiLabel:"API: GET /api/v1/users/profile"}),r&&e.jsx(C,{message:"Loading profile..."}),!r&&t&&e.jsx(L,{error:t,endpoint:"GET /api/v1/users/profile",onRetry:()=>u()}),!r&&!t&&a&&e.jsx("div",{className:"card profile-card",children:v?e.jsxs("form",{onSubmit:b,className:"profile-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"name",children:"Name"}),e.jsx("input",{type:"text",id:"name",name:"name",value:c.name,onChange:h,placeholder:"Enter your full name"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"phone",children:"Phone"}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:c.phone,onChange:h,placeholder:"Enter your phone number"})]}),e.jsxs("div",{className:"profile-actions",children:[e.jsx("button",{type:"button",onClick:N,disabled:l,children:"Cancel"}),e.jsx("button",{type:"submit",className:"primary",disabled:l,children:l?"Saving...":"Save Changes"})]})]}):e.jsxs("div",{className:"profile-view",children:[e.jsxs("div",{className:"profile-field",children:[e.jsx("label",{children:"User ID"}),e.jsx("span",{children:a.id||"N/A"})]}),e.jsxs("div",{className:"profile-field",children:[e.jsx("label",{children:"Username"}),e.jsx("span",{children:a.username||"N/A"})]}),e.jsxs("div",{className:"profile-field",children:[e.jsx("label",{children:"Email"}),e.jsx("span",{children:a.email||"N/A"})]}),e.jsxs("div",{className:"profile-field",children:[e.jsx("label",{children:"Name"}),e.jsx("span",{children:a.name||"Not set"})]}),e.jsxs("div",{className:"profile-field",children:[e.jsx("label",{children:"Phone"}),e.jsx("span",{children:a.phone||"Not set"})]}),e.jsx("button",{className:"primary",onClick:()=>o(!0),children:"Edit Profile"})]})}),e.jsx(S,{data:a})]}):e.jsxs("div",{className:"page container",children:[e.jsx(x,{title:"My Profile",backLink:"/",backText:"â† Back to Home"}),e.jsx(w,{message:"Please log in to view your profile",icon:"ğŸ”’"})]})}export{R as default};
