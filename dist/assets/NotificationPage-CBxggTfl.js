import{c as M,r as t,j as e,m as b,n as y}from"./index-B_7VeGgU.js";import{u as E,a as L,P as N,L as _,A as R}from"./ApiDebug-CcPvt7Y2.js";import{u as P}from"./useApiMutation-UM5EO7mV.js";import{A as w}from"./ApiError-bnzA-mkx.js";import{E as v}from"./EmptyState-CHFLAYQf.js";import"./errorMessages-JRjuVPVt.js";function G(){const l=M(),{isAuthenticated:m,requireAuth:h}=E();t.useEffect(()=>{h(l,"/notifications")},[h,l]);const{data:i,loading:n,error:r,mutate:c}=L(m?"notifications":null,b),{mutate:k,loading:u}=P(y,{successMessage:"Marked as read",errorMessage:"Failed to mark as read"}),A=async s=>{c(i==null?void 0:i.map(d=>d.id===s?{...d,read:!0}:d),!1);const f=await k(s);c()},a=t.useMemo(()=>i||[],[i]),o=t.useMemo(()=>a.filter(s=>!s.read).length,[a]),x=t.useMemo(()=>a.filter(s=>!s.read),[a]),g=t.useMemo(()=>a.filter(s=>s.read),[a]),p=s=>({order_shipped:"üì¶",order_completed:"‚úÖ",order_placed:"üõí",order_processing:"‚öôÔ∏è",review_reminder:"‚≠ê",promotion:"üéâ",cart_reminder:"üõçÔ∏è",email:"üìß",sms:"üì±"})[s]||"üîî",j=s=>{if(!s)return"";try{return new Date(s).toLocaleString()}catch{return""}};return m?e.jsxs("div",{className:"page container",children:[e.jsx(N,{title:"Notifications",backLink:"/",backText:"‚Üê Back to Home",apiLabel:`API: GET /api/v1/notifications ‚Ä¢ ${a.length} items`}),n&&e.jsx(_,{message:"Loading notifications...",variant:"list",count:3}),!n&&r&&e.jsx(w,{error:r,endpoint:"GET /api/v1/notifications"}),!n&&!r&&a.length===0&&e.jsx(v,{message:"No notifications",icon:"üîî"}),!n&&!r&&a.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notification-summary",children:e.jsx("p",{children:o>0?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:o})," unread notification",o!==1?"s":""]}):"All caught up! üéâ"})}),x.length>0&&e.jsxs("div",{className:"notification-section unread",children:[e.jsx("h3",{children:"Unread"}),x.map(s=>e.jsx("div",{className:"notification-item unread",children:e.jsxs("div",{className:"notification-content",children:[e.jsxs("div",{className:"notification-body",children:[e.jsxs("div",{className:"notification-header",children:[e.jsx("span",{className:"notification-icon",children:p(s.type)}),e.jsx("h4",{className:"notification-title",children:s.title||s.message})]}),s.title&&s.message!==s.title&&e.jsx("p",{className:"notification-message",children:s.message}),e.jsx("p",{className:"notification-time",children:j(s.created_at)})]}),e.jsx("div",{className:"notification-actions",children:e.jsx("button",{className:"primary",onClick:()=>A(s.id),disabled:u,children:u?"Marking...":"Mark as Read"})})]})},s.id))]}),g.length>0&&e.jsxs("div",{className:"notification-section read",children:[e.jsx("h3",{children:"Read"}),g.map(s=>e.jsx("div",{className:"notification-item read",children:e.jsxs("div",{className:"notification-body",children:[e.jsxs("div",{className:"notification-header",children:[e.jsx("span",{className:"notification-icon",children:p(s.type)}),e.jsx("h4",{className:"notification-title",children:s.title||s.message})]}),s.title&&s.message!==s.title&&e.jsx("p",{className:"notification-message",children:s.message}),e.jsx("p",{className:"notification-time",children:j(s.created_at)})]})},s.id))]})]}),e.jsx(R,{data:i})]}):e.jsxs("div",{className:"page container",children:[e.jsx(N,{title:"Notifications",backLink:"/",backText:"‚Üê Back to Home"}),e.jsx(v,{message:"Please log in to view notifications",icon:"üîí"})]})}export{G as default};
